!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var s,o,i,c,r={sendGetRequest:function(e,t){const n=this.generateURL(e);return $.ajax({url:n,type:"GET",data:t,contentType:"application/json; charset=utf-8",dataType:"json"})},sendPostRequest:function(e,t){const n=this.generateURL(e);return $.ajax({url:n,type:"POST",data:JSON.stringify({payload:t}),contentType:"application/json; charset=utf-8",dataType:"json"})},generateURL:function(e){return location.protocol+"//"+location.host+e}},a={init:function(){this.buttons.forEach(e=>{const t=this;$(e.id).click(function(){if(e.cliked)t.deactivateRest(e.id,e.container);else{t.activateButton(e.id,e.container);const n=t.buttons.find(t=>1==t.cliked&&t.id!=e.id);n&&t.deactivateRest(n.id,n.container)}})})},buttons:[{id:"#seed-button",container:"#seed-inputs-wrapper",cliked:!1},{id:"#kmeans-button",container:"#kmeans-inputs-wrapper",cliked:!1},{id:"#fuzzy-button",container:"#fuzzy-inputs-wrapper",cliked:!1}],activateButton:function(e,t){$(e).css({"background-color":"#21a522"}),$(t).css({display:"inherit"}),this.buttons.forEach(t=>{t.id==e&&(t.cliked=!0)})},deactivateRest:function(e,t){$(e).css({"background-color":"#20a5d6"}),$(t).css({display:"none"}),this.buttons.forEach(t=>{t.id==e&&(t.cliked=!1)})}},l=[],u=[];function d(e){$("#dicom-images-carousel").carousel();for(let t=1;t<=e;t++)$(`.item${t}`).click(function(){$("#dicom-images-carousel").carousel(t-1)});$(".carousel-control-prev").click(function(){$("#dicom-images-carousel").carousel("prev")}),$(".carousel-control-next").click(function(){$("#dicom-images-carousel").carousel("next")})}$(document).ready(function(){a.init(),$("#processing-button").click(()=>{if("rgb(33, 165, 34)"==$("#seed-button").css("background-color")){const e=$("input[type=radio][name=seed]:checked").val(),t=$("input[type=radio][name='neighbours']:checked").val(),n=$("input[type=number][name='seed']").val(),o="/seed"+`?fileName=${s}&ratio=${n}&neighboursNumber=${t}&distance=${e}`;r.sendPostRequest(o,l).done(function(e){$("#spinner").html("<p>processing finished</p>");const t=cv.matFromArray(512,512,cv.CV_8U,[].concat.apply([],e.result));cv.imshow("canvasOutput",t)}).fail(function(e){console.log(e)})}}),$("#processing-button").click(()=>{if("rgb(33, 165, 34)"==$("#kmeans-button").css("background-color")){const e=$("input[type=number][name='kmeans']").val(),t={fileName:s,clustersNumber:e};r.sendGetRequest("/kmeans/step1",t).done(function(t){i=t.arrayOfImgs,t.arrayOfImgs.forEach((e,t)=>{const n=cv.matFromArray(512,512,cv.CV_8U,[].concat.apply([],e));let s,o;0===t?(s=`\n              <div class='carousel-item active'" + ">\n                      <div class="slide-name" style='color:white;font-size:20px'>Cluster number: ${t+1}</div> \n                      <canvas id='canvas${t}'></canvas>\n              </div>`,o=`<li class='item${t+1} active'" + "></li>`):(s=`\n              <div class='carousel-item'" + ">\n                      <div class="slide-name" style='color:white;font-size:20px'>Cluster number: ${t+1}</div>\n                      <canvas id='canvas${t}'></canvas>\n              </div>`,o=`<li class='item${t+1}'" + "></li>`),$(".carousel-inner").append(s),$(".carousel-indicators").append(o),$(".carousel-item").css({width:"100%",height:"600px"}),cv.imshow(`canvas${t}`,n)}),d(e),$("#dicomImgModal").modal()}).fail(function(e){console.log(e)})}}),$(".carousel-submit-button").click(()=>{if("step2"===$(".carousel-input").attr("name")){const e=$(".filters-list").find("li").filter(function(){return"rgb(208, 156, 0)"===$(this).css("background-color")}).index();r.sendGetRequest("/kmeans/step2",{filterNumber:e+1,imgNumber:c-1,reconstructionCoords:u}).done(function(e){console.log(e)}).fail(function(e){console.log(e)})}else{c=$(".carousel-input").val();const e=cv.matFromArray(512,512,cv.CV_8U,[].concat.apply([],i[c-1]));let t,n;$(".modal-title").text("Step 2: select further processing filter number"),$(".processing-filters").css({display:"inherit",color:"white"}),$(".carousel-input").attr("name","step2"),t="\n      <div class='carousel-item active'\" + \">\n              <div class=\"slide-name\" style='color:white;font-size:20px'>Choosen image for further processing</div> \n              <canvas id='canvas1'></canvas>\n      </div>",n="<li class='item1 active'\" + \"></li>",$(".carousel-inner").html(t),$(".carousel-indicators").html(n),$(".carousel-item").css({width:"100%",height:"600px"}),cv.imshow("canvas1",e),d(1),$("#dicomImgModal").modal()}}),$(".filters-list li").click(function(){$(this).css({"background-color":"#d09c00"});for(let e=0;e<5;e++)$(this).index()!==e&&"rgb(68, 66, 66)"!==$(`.filters-list li:nth-child(${e+1})`).css("background-color")&&$(`.filters-list li:nth-child(${e+1})`).css({"background-color":"rgb(68, 66, 66)"});switch($(this).index()){case 0:$(".reconstruction-pts").removeClass("d-none"),$(".reconstruction-pts").addClass("d-flex"),$("#canvas1").css({cursor:"crosshair"})}}),$(".carousel-inner").delegate("#canvas1","click",function(e){console.log("canvas1"),$(".reconstruction-no-points").remove(),u.push({x:e.offsetX,y:e.offsetY}),$("#reconstruction-points-container").append(`<li>x: ${e.offsetX} y: ${e.offsetY}</li>`)}),$("#processing-button").click(()=>{if("rgb(33, 165, 34)"==$("#fuzzy-button").css("background-color")){const e=$("input[type=number][name='fuzzy']").val(),t={fileName:s,clustersNumber:e};r.sendGetRequest("/fuzzy",t).done(function(e){$("#spinner").html("<p>processing finished</p>"),console.log(e.result);let t=cv.matFromArray(1,8,cv.CV_8UC1,e.result);console.log(t.data),cv.imshow("canvasOutput",t)}).fail(function(e){console.log(e)})}}),$('input[type="file"]').change(function(e){s=e.target.files[0].name,$('input[type="file"]')&&$("#buttons-wrapper").css("visibility","visible")}),$(".cornerstone-canvas").click(function(e){$("#seed-list-item").length||$("#no-seeds").remove(),l.push({x:e.offsetX,y:e.offsetY}),o=$(`<li id="seed-list-item">X: ${e.offsetX} Y: ${e.offsetY}</li>`),$("#seed-list").append(o)})})}]);